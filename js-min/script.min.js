let cubeSize=[3,3],cubeControl="white",cubes=0,arrowStickers=[];const addArrow=clickedElement=>{if(1==arrowStickers.length){let cubeNumber=u(clickedElement).attr("id").split("r")[0],lastCubeNumber;if(cubeNumber==arrowStickers[0].split("r")[0]){let arrow=u("<connection>").attr("from",`#${arrowStickers[0]}`).attr("to",`#${u(clickedElement).attr("id")}`).attr("tail","");u(`#${cubeNumber}`).append(arrow),arrowStickers=[]}else arrowStickers=[u(clickedElement).attr("id")]}else arrowStickers.push(u(clickedElement).attr("id"))},removeCube=clickedElement=>{let cubeId=u(clickedElement).attr("id").split("r")[0],removeConfirm;if(!confirm("Do you want to remove the cube and all arrows?"))return!1;u(`#${cubeId}`).remove(),u("connection").remove()},stickerClicked=clickedElement=>"showHide"==cubeControl?u(clickedElement).toggleClass("hidden"):"addArrow"==cubeControl?addArrow(clickedElement):"removeCube"==cubeControl?removeCube(clickedElement):u(clickedElement).hasClass("hidden")?void 0:u(clickedElement).removeClass("green","white","red","yellow","blue","orange").addClass(cubeControl),createCube=()=>{let newCube=u("<div>").addClass("cubeGrid");for(var r=0;r<cubeSize[0]+2;r++)for(var c=0;c<cubeSize[1]+2;c++){let cubeSticker=u("<div>").addClass("cubeSticker").attr("id",`cube${cubes}r${r}c${c}`);0!=r&&r!=cubeSize[0]+1||0!=c&&c!=cubeSize[1]+1?cubeSticker.on("click",clickedElement=>stickerClicked(clickedElement.srcElement)).addClass("white"):cubeSticker.addClass("cubeCorner"),newCube.append(cubeSticker)}try{let algName=u("<div>").attr("contenteditable","true").addClass("algName").text("Write Algorithm Name Here!").on("keypress",e=>{13==e.keyCode&&e.preventDefault()}),alg=u("<div>").attr("contenteditable","true").addClass("alg").text("Write Algorithm Here!").on("keypress",e=>{13==e.keyCode&&(e.preventDefault(),u(e.srcElement).append("<br>"))}),cubeContainer=u("<div>").addClass("cubeContainer").append(newCube).append(algName).append(alg).attr("id",`cube${cubes}`);u(".cubes").append(cubeContainer)}catch(e){return console.log(e)}finally{console.log("Cube Created!"),cubes++,console.log(`Cubes: ${cubes}`)}},downloadFile=(file,filename)=>{let link=document.createElement("a");link.href=file,link.setAttribute("download",filename),document.body.appendChild(link),link.click(),document.body.removeChild(link)},downloadCubes=()=>{u(".cubeContainer").each((node,i)=>{domtoimage.toPng(node).then(dataUrl=>{let img=new Image;img.src=dataUrl,downloadFile(img.src,`cube${i+1}.png`)}).catch(e=>console.error(e))}),domtoimage.toPng(u(".cubes")).then(dataUrl=>{let img=new Image;img.src=dataUrl,downloadFile(img,"cubes.png")}).catch(e=>console.log(e)),console.log("Downloaded Cubes!")};u(".createCube").on("click",createCube),u(".cubeControl").on("click",clickedElement=>cubeControl=u(clickedElement.srcElement).attr("control")),u(".downloadCubes").on("click",downloadCubes);